{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\ud83e\uddec methurator","text":"<p>methurator is a Python package to estimate CpG sequencing saturation for DNA methylation sequencing data. It supports two complementary approaches:</p> <ol> <li>Chao's estimator (recommended)</li> <li>Empirical downsampling</li> </ol>"},{"location":"#key-features","title":"Key features","text":"<ul> <li>Extrapolate CpG discovery beyond observed sequencing depth</li> <li>Compute theoretical asymptotes</li> <li>Optional bootstrap confidence intervals</li> <li>Interactive HTML plots</li> <li>BioConda and BioContainer support</li> </ul>"},{"location":"#installation","title":"Installation","text":"Pip <p>install dependencies</p> <p>If you install methurator via pip, be sure to install its dependencies SAMtools and MethylDackel.</p> <pre><code>```bash\npip install methurator\n```\n</code></pre> BioCondaBioContainer <pre><code>conda create -n methurator_env conda::methurator\nconda activate methurator_env\n</code></pre> <pre><code>docker pull quay.io/biocontainers/methurator:2.1.0--pyhdfd78af_0\ndocker run quay.io/biocontainers/methurator:2.1.0--pyhdfd78af_0 methurator -h\n</code></pre>"},{"location":"methodology/","title":"Methodology","text":""},{"location":"methodology/#how-do-we-compute-the-sequencing-saturation","title":"How do we compute the sequencing saturation?","text":""},{"location":"methodology/#chao-estimator-approach-best-practise","title":"Chao Estimator approach (best practise)","text":"<p>methurator gt-estimator uses an approach developed in 2018 by Chao Deng et al and further implemented in preseqR. This approach builds on the theoretical nonparametric empirical Bayes foundation of Good and Toulmin (1956), to model sequencing saturation and extrapolate to higher sequencing depths. The model implemented in preseqR was mirrored here and tailored toward sequencing saturation application. The workflow consists of the following steps:</p> <ol> <li>Extracts CpGs from BAM files using MethylDackel</li> <li>Fits the model implemented by Chao Deng et al taking in input the observed CpG counts</li> <li>Predicts future CpG discovery using rational function approximations</li> <li>Quantifies confidence intervals through bootstrap resampling (if enabled)</li> </ol> <p>The extrapolation factor (t) represents the ratio of hypothetical total reads to actual observed reads. Values of t \u2264 1 correspond to interpolation (between observed data points), while t &gt; 1 represents extrapolation (prediction beyond observed depth).</p> <p>For a given coverage level:</p> <ul> <li>At t = 1: prediction matches observed CpGs, and the number of reads at full sequencing depth is reported in the summary file</li> <li>As t increases: predictions approach the theoretical asymptote (maximum CpGs at t = 1000, shown in the plot and used for saturation calculation)</li> </ul>"},{"location":"methodology/#downsample-approach","title":"Downsample approach","text":"<p>To calculate the sequencing saturation of an DNAm sample when using the <code>downsample</code> command, we adopt the following strategy. For each sample, we downsample it according to 4 different percentages (default: <code>0.1,0.2,0.4,0.6,0.8</code>). Then, we compute the number of unique CpGs covered by at least 3 reads and the number of reads at each downsampling percentage.</p> <p>We then fit the following curve using the <code>scipy.optimize.curve_fit</code> function:</p> <p>$$ y = \\beta_0 \\cdot \\arctan(\\beta_1 \\cdot x) $$</p> <p>We chose the arctangent function because it exhibits an asymptotic growth similar to sequencing saturation. For large values of $\\text{x}$ (as $\\text{x} \\to \\infty$), the asymptote corresponds to the theoretical maximum number of unique CpGs covered by at least 3 reads and can be computed as:</p> <p>$$ \\text{asymptote} = \\beta_0 \\cdot \\frac{\\pi}{2} $$</p> <p>Finally, the sequencing saturation value can be calculated as following:</p> <p>$$ \\text{Saturation} = \\frac{\\text{Number of unique CpGs (\u22653 counts)}}{\\text{Asymptote}} $$</p> <p>This approach allows estimation of the theoretical maximum number of CpGs that can be detected given an infinite sequencing depth, and quantifies how close the sample is to reaching sequencing saturation.</p>"},{"location":"quickstart/","title":"Quick Start","text":""},{"location":"quickstart/#option-a-chao-estimator-best-practise","title":"Option A: Chao Estimator (best practise)","text":"<p>The <code>gt-estimator</code> command estimates CpGs sequencing saturation at higher depth than the observed one. This is the recommended approach for extrapolation analysis.</p> <pre><code>methurator gt-estimator --fasta tests/data/genome.fa tests/data/Ecoli.csorted.bam\n</code></pre> <p>This command generates:</p> <ul> <li>Summary YAML file (<code>methurator_summary.yml</code>) \u2014 Contains metadata, model parameters, and extrapolation results with:</li> <li>Extrapolation factor (t) values from 0 to <code>--t-max</code> (default: 10.0)</li> <li>Boolean indicating interpolated (t \u2264 1) vs extrapolated (t &gt; 1) data</li> <li>Total CpGs predicted at each t value</li> <li>Theoretical asymptote (maximum CpGs, computed at t = 1000)</li> <li>Number of reads observed at full sequencing depth (t = 1)</li> <li>Confidence intervals (if <code>--compute_ci</code> is enabled)</li> </ul>"},{"location":"quickstart/#option-b-downsample","title":"Option B: Downsample","text":"<p>The <code>downsample</code> command performs BAM downsampling according to specified percentages and coverage levels:</p> <pre><code>methurator downsample --fasta tests/data/genome.fa tests/data/Ecoli.csorted.bam\n</code></pre> <p>This command generates:</p> <ul> <li>CpG summary (<code>methurator_cpgs_summary.yml</code>)\u2014 number of unique CpGs detected in each downsampled BAM</li> <li>Reads summary (<code>methurator_reads_summary.yml</code>) \u2014 number of reads in each downsampled BAM</li> <li>Summary YAML (<code>methurator_summary.yml</code>) \u2014 consolidated file with all data and run metadata</li> </ul>"},{"location":"quickstart/#plot-the-sequencing-saturation-curve","title":"Plot the sequencing saturation curve","text":"<p>Use the <code>plot</code> command to visualize the results, including the asymptote line and the number of reads at each t:</p> <pre><code>methurator plot --summary output/methurator_summary.yml\n</code></pre>"},{"location":"workflow/","title":"Example Workflow","text":""},{"location":"workflow/#example-workflow","title":"Example Workflow","text":""},{"location":"workflow/#using-chao-estimator-recommended","title":"Using Chao Estimator (Recommended)","text":"<pre><code># Run Chao estimator on BAM file\nmethurator gt-estimator --genome hg19 my_sample.bam --config_ci\n\n# Generate plots from the results\nmethurator plot --summary output/methurator_summary.yml\n</code></pre> <p>Example plot preview (also available as interactive html file here):</p> <p></p>"},{"location":"workflow/#using-downsample","title":"Using Downsample","text":"<pre><code># Downsample BAM file\nmethurator downsample --genome hg19 my_sample.bam\n\n# Generate plots from the results\nmethurator plot --summary output/methurator_summary.yml\n</code></pre> <p>The output plots will be saved in <code>output/plots/</code> as interactive HTML files showing the CpG predictions, the asymptote (theoretical maximum CpGs at t = 1000), the number of reads at each t, and confidence intervals (if enabled). The asymptote is now also used to compute the saturation values.</p> <p>Example plot preview (also available as interactive html file here):</p> <p></p>"},{"location":"commands/downsample/","title":"downsample","text":""},{"location":"commands/downsample/#downsample-command","title":"<code>downsample</code> command","text":"Option Description Default <code>BAM (positional)</code> Path to a single <code>.bam</code> file or multiple files (e.g. <code>files/*.bam</code>). \u2014 <code>--outdir, -o</code> Output directory. <code>./output</code> <code>--fasta</code> Path to the reference genome FASTA file. If not provided, it will be automatically downloaded based on <code>--genome</code>. \u2014 <code>--genome</code> Genome used for alignment. Options: <code>hg19</code>, <code>hg38</code>, <code>GRCh37</code>, <code>GRCh38</code>, <code>mm10</code>, <code>mm39</code>. \u2014 <code>--downsampling-percentages, -ds</code> Comma-separated list of downsampling percentages (between 0 and 1, exclusive). <code>0.1,0.2,0.4,0.6,0.8</code> <code>--minimum-coverage, -mc</code> Minimum CpG coverage to consider for saturation. Can be a single integer or a list (e.g. <code>1,3,5</code>). <code>3</code> <code>--rrbs</code> If set, MethylDackel will consider the RRBS nature of the data by adding the <code>--keepDupes</code> flag. <code>False</code> <code>--threads, -@</code> Number of threads to use during downsampling. All available threads <code>--keep-temporary-files</code> Keep temporary files after analysis. <code>False</code> <code>--verbose</code> Enable verbose logging. <code>False</code> <code>--help, -h</code> Print the help message and exit. \u2014 <code>--version</code> Print the package version. \u2014"},{"location":"commands/gt_estimator/","title":"gt-estimator","text":""},{"location":"commands/gt_estimator/#gt-estimator-command","title":"<code>gt-estimator</code> command","text":"Argument Description Default <code>BAM (positional)</code> Path to a single <code>.bam</code> file or multiple files (e.g. <code>files/*.bam</code>). \u2014 <code>--outdir, -o</code> Output directory. <code>./output</code> <code>--fasta</code> Path to the reference genome FASTA file. If not provided, it will be automatically downloaded based on <code>--genome</code>. \u2014 <code>--genome</code> Genome used for alignment. Options: <code>hg19</code>, <code>hg38</code>, <code>GRCh37</code>, <code>GRCh38</code>, <code>mm10</code>, <code>mm39</code>. \u2014 <code>--minimum-coverage, -mc</code> Minimum CpG coverage to consider. Can be a single integer or a list (e.g. <code>1,3,5</code>). <code>1</code> <code>--t-step</code> Step size for extrapolation factor (<code>t</code>) predictions. <code>0.05</code> <code>--t-max</code> Maximum extrapolation factor (<code>t</code>). <code>10.0</code> <code>--compute_ci</code> Compute confidence intervals using bootstrap replicates. <code>False</code> <code>--bootstrap-replicates, -b</code> Number of bootstrap replicates for CI computation. <code>30</code> <code>--conf</code> Confidence level for bootstrap intervals. <code>0.95</code> <code>--mu</code> Initial <code>mu</code> parameter for the negative binomial distribution in the EM algorithm. <code>0.5</code> <code>--size</code> Initial <code>size</code> parameter for the negative binomial distribution in the EM algorithm. <code>1.0</code> <code>--mt</code> Constraint for rational function approximations. <code>20</code> <code>--rrbs</code> If set to <code>True</code>, MethylDackel will use the RRBS flag (<code>--keepDupes</code>). <code>False</code> <code>--threads, -@</code> Number of threads to use. Available threads - 2 <code>--keep-temporary-files, -k</code> Keep temporary files after analysis. <code>False</code> <code>--verbose</code> Enable verbose logging. <code>False</code> <code>--help, -h</code> Print the help message and exit. \u2014 <code>--version</code> Print the package version. \u2014"},{"location":"commands/plot/","title":"plot","text":""},{"location":"commands/plot/#plot-command","title":"<code>plot</code> command","text":"Argument Description Default <code>--summary</code>, <code>-s</code> Path to the YML summary file. <code>--outdir</code>, <code>-o</code> Output directory. <code>./output</code> <code>--verbose</code> Enable verbose logging. <code>False</code> <code>--help</code> , <code>-h</code> Print the help message and exit. <code>--version</code> Print the package version."}]}