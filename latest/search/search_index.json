{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\ud83e\uddec methurator methurator is a Python package to estimate CpG sequencing saturation for DNA methylation sequencing data. It supports two complementary approaches: Chao's estimator (recommended) Empirical downsampling Key features Extrapolate CpG discovery beyond observed sequencing depth Compute theoretical asymptotes Optional bootstrap confidence intervals Interactive HTML plots BioConda and BioContainer support Installation Pip Dependencies If you install methurator via pip, be sure to install its dependencies SAMtools and MethylDackel . pip install methurator BioConda conda create -n methurator_env conda::methurator conda activate methurator_env BioContainer docker pull quay.io/biocontainers/methurator:2.1.0--pyhdfd78af_0 docker run quay.io/biocontainers/methurator:2.1.0--pyhdfd78af_0 methurator -h","title":"Home"},{"location":"#methurator","text":"methurator is a Python package to estimate CpG sequencing saturation for DNA methylation sequencing data. It supports two complementary approaches: Chao's estimator (recommended) Empirical downsampling","title":"\ud83e\uddec methurator"},{"location":"#key-features","text":"Extrapolate CpG discovery beyond observed sequencing depth Compute theoretical asymptotes Optional bootstrap confidence intervals Interactive HTML plots BioConda and BioContainer support","title":"Key features"},{"location":"#installation","text":"","title":"Installation"},{"location":"#pip","text":"Dependencies If you install methurator via pip, be sure to install its dependencies SAMtools and MethylDackel . pip install methurator","title":"Pip"},{"location":"#bioconda","text":"conda create -n methurator_env conda::methurator conda activate methurator_env","title":"BioConda"},{"location":"#biocontainer","text":"docker pull quay.io/biocontainers/methurator:2.1.0--pyhdfd78af_0 docker run quay.io/biocontainers/methurator:2.1.0--pyhdfd78af_0 methurator -h","title":"BioContainer"},{"location":"methodology/","text":"How do we compute the sequencing saturation? 1. Chao Estimator approach (best practise) methurator gt-estimator uses an approach developed in 2018 by Chao Deng et al and further implemented in preseqR . This approach builds on the theoretical nonparametric empirical Bayes foundation of Good and Toulmin (1956) , to model sequencing saturation and extrapolate to higher sequencing depths. The model implemented in preseqR was mirrored here and tailored toward sequencing saturation application. The workflow consists of the following steps: Extracts CpGs from BAM files using MethylDackel Fits the model implemented by Chao Deng et al taking in input the observed CpG counts Predicts future CpG discovery using rational function approximations Quantifies confidence intervals through bootstrap resampling (if enabled) The extrapolation factor (t) represents the ratio of hypothetical total reads to actual observed reads. Values of t \u2264 1 correspond to interpolation (between observed data points), while t > 1 represents extrapolation (prediction beyond observed depth). For a given coverage level: At t = 1: prediction matches observed CpGs, and the number of reads at full sequencing depth is reported in the summary file As t increases: predictions approach the theoretical asymptote (maximum CpGs at t = 1000, shown in the plot and used for saturation calculation) 2. Downsample approach To calculate the sequencing saturation of an DNAm sample when using the downsample command, we adopt the following strategy. For each sample, we downsample it according to 4 different percentages (default: 0.1,0.2,0.4,0.6,0.8 ). Then, we compute the number of unique CpGs covered by at least 3 reads and the number of reads at each downsampling percentage. We then fit the following curve using the scipy.optimize.curve_fit function: \\[ y = \\beta_0 \\cdot \\arctan(\\beta_1 \\cdot x) \\] We chose the arctangent function because it exhibits an asymptotic growth similar to sequencing saturation. For large values of \\(\\text{x}\\) (as \\(\\text{x} \\to \\infty\\) ), the asymptote corresponds to the theoretical maximum number of unique CpGs covered by at least 3 reads and can be computed as: \\[ \\text{asymptote} = \\beta_0 \\cdot \\frac{\\pi}{2} \\] Finally, the sequencing saturation value can be calculated as following: \\[ \\text{Saturation} = \\frac{\\text{Number of unique CpGs (\u22653 counts)}}{\\text{Asymptote}} \\] This approach allows estimation of the theoretical maximum number of CpGs that can be detected given an infinite sequencing depth, and quantifies how close the sample is to reaching sequencing saturation.","title":"Methodology"},{"location":"methodology/#how-do-we-compute-the-sequencing-saturation","text":"","title":"How do we compute the sequencing saturation?"},{"location":"methodology/#1-chao-estimator-approach-best-practise","text":"methurator gt-estimator uses an approach developed in 2018 by Chao Deng et al and further implemented in preseqR . This approach builds on the theoretical nonparametric empirical Bayes foundation of Good and Toulmin (1956) , to model sequencing saturation and extrapolate to higher sequencing depths. The model implemented in preseqR was mirrored here and tailored toward sequencing saturation application. The workflow consists of the following steps: Extracts CpGs from BAM files using MethylDackel Fits the model implemented by Chao Deng et al taking in input the observed CpG counts Predicts future CpG discovery using rational function approximations Quantifies confidence intervals through bootstrap resampling (if enabled) The extrapolation factor (t) represents the ratio of hypothetical total reads to actual observed reads. Values of t \u2264 1 correspond to interpolation (between observed data points), while t > 1 represents extrapolation (prediction beyond observed depth). For a given coverage level: At t = 1: prediction matches observed CpGs, and the number of reads at full sequencing depth is reported in the summary file As t increases: predictions approach the theoretical asymptote (maximum CpGs at t = 1000, shown in the plot and used for saturation calculation)","title":"1. Chao Estimator approach (best practise)"},{"location":"methodology/#2-downsample-approach","text":"To calculate the sequencing saturation of an DNAm sample when using the downsample command, we adopt the following strategy. For each sample, we downsample it according to 4 different percentages (default: 0.1,0.2,0.4,0.6,0.8 ). Then, we compute the number of unique CpGs covered by at least 3 reads and the number of reads at each downsampling percentage. We then fit the following curve using the scipy.optimize.curve_fit function: \\[ y = \\beta_0 \\cdot \\arctan(\\beta_1 \\cdot x) \\] We chose the arctangent function because it exhibits an asymptotic growth similar to sequencing saturation. For large values of \\(\\text{x}\\) (as \\(\\text{x} \\to \\infty\\) ), the asymptote corresponds to the theoretical maximum number of unique CpGs covered by at least 3 reads and can be computed as: \\[ \\text{asymptote} = \\beta_0 \\cdot \\frac{\\pi}{2} \\] Finally, the sequencing saturation value can be calculated as following: \\[ \\text{Saturation} = \\frac{\\text{Number of unique CpGs (\u22653 counts)}}{\\text{Asymptote}} \\] This approach allows estimation of the theoretical maximum number of CpGs that can be detected given an infinite sequencing depth, and quantifies how close the sample is to reaching sequencing saturation.","title":"2. Downsample approach"},{"location":"quickstart/","text":"Quick Start Option A: Chao Estimator (best practise) The gt-estimator command estimates CpGs sequencing saturation at higher depth than the observed one. This is the recommended approach for extrapolation analysis. methurator gt-estimator --fasta tests/data/genome.fa tests/data/Ecoli.csorted.bam This command generates: Summary YAML file ( methurator_summary.yml ) \u2014 Contains metadata, model parameters, and extrapolation results with: Extrapolation factor (t) values from 0 to --t-max (default: 10.0) Boolean indicating interpolated (t \u2264 1) vs extrapolated (t > 1) data Total CpGs predicted at each t value Theoretical asymptote (maximum CpGs, computed at t = 1000) Number of reads observed at full sequencing depth (t = 1) Confidence intervals (if --compute_ci is enabled) Option B: Downsample The downsample command performs BAM downsampling according to specified percentages and coverage levels: methurator downsample --fasta tests/data/genome.fa tests/data/Ecoli.csorted.bam This command generates: CpG summary ( methurator_cpgs_summary.yml )\u2014 number of unique CpGs detected in each downsampled BAM Reads summary ( methurator_reads_summary.yml ) \u2014 number of reads in each downsampled BAM Summary YAML ( methurator_summary.yml ) \u2014 consolidated file with all data and run metadata Plot the sequencing saturation curve Use the plot command to visualize the results, including the asymptote line and the number of reads at each t: methurator plot --summary output/methurator_summary.yml","title":"Quick Start"},{"location":"quickstart/#quick-start","text":"","title":"Quick Start"},{"location":"quickstart/#option-a-chao-estimator-best-practise","text":"The gt-estimator command estimates CpGs sequencing saturation at higher depth than the observed one. This is the recommended approach for extrapolation analysis. methurator gt-estimator --fasta tests/data/genome.fa tests/data/Ecoli.csorted.bam This command generates: Summary YAML file ( methurator_summary.yml ) \u2014 Contains metadata, model parameters, and extrapolation results with: Extrapolation factor (t) values from 0 to --t-max (default: 10.0) Boolean indicating interpolated (t \u2264 1) vs extrapolated (t > 1) data Total CpGs predicted at each t value Theoretical asymptote (maximum CpGs, computed at t = 1000) Number of reads observed at full sequencing depth (t = 1) Confidence intervals (if --compute_ci is enabled)","title":"Option A: Chao Estimator (best practise)"},{"location":"quickstart/#option-b-downsample","text":"The downsample command performs BAM downsampling according to specified percentages and coverage levels: methurator downsample --fasta tests/data/genome.fa tests/data/Ecoli.csorted.bam This command generates: CpG summary ( methurator_cpgs_summary.yml )\u2014 number of unique CpGs detected in each downsampled BAM Reads summary ( methurator_reads_summary.yml ) \u2014 number of reads in each downsampled BAM Summary YAML ( methurator_summary.yml ) \u2014 consolidated file with all data and run metadata","title":"Option B: Downsample"},{"location":"quickstart/#plot-the-sequencing-saturation-curve","text":"Use the plot command to visualize the results, including the asymptote line and the number of reads at each t: methurator plot --summary output/methurator_summary.yml","title":"Plot the sequencing saturation curve"},{"location":"workflow/","text":"Example Workflow Using Chao Estimator (Recommended) # Run Chao estimator on BAM file methurator gt-estimator --genome hg19 my_sample.bam --config_ci # Generate plots from the results methurator plot --summary output/methurator_summary.yml Example plot preview (also available as interactive html file here ): Using Downsample # Downsample BAM file methurator downsample --genome hg19 my_sample.bam # Generate plots from the results methurator plot --summary output/methurator_summary.yml The output plots will be saved in output/plots/ as interactive HTML files showing the CpG predictions, the asymptote (theoretical maximum CpGs at t = 1000), the number of reads at each t, and confidence intervals (if enabled). The asymptote is now also used to compute the saturation values. Example plot preview (also available as interactive html file here ):","title":"Example Workflow"},{"location":"workflow/#example-workflow","text":"","title":"Example Workflow"},{"location":"workflow/#using-chao-estimator-recommended","text":"# Run Chao estimator on BAM file methurator gt-estimator --genome hg19 my_sample.bam --config_ci # Generate plots from the results methurator plot --summary output/methurator_summary.yml Example plot preview (also available as interactive html file here ):","title":"Using Chao Estimator (Recommended)"},{"location":"workflow/#using-downsample","text":"# Downsample BAM file methurator downsample --genome hg19 my_sample.bam # Generate plots from the results methurator plot --summary output/methurator_summary.yml The output plots will be saved in output/plots/ as interactive HTML files showing the CpG predictions, the asymptote (theoretical maximum CpGs at t = 1000), the number of reads at each t, and confidence intervals (if enabled). The asymptote is now also used to compute the saturation values. Example plot preview (also available as interactive html file here ):","title":"Using Downsample"},{"location":"commands/downsample/","text":"downsample command Option Description Default BAM (positional) Path to a single .bam file or multiple files (e.g. files/*.bam ). \u2014 --outdir, -o Output directory. ./output --fasta Path to the reference genome FASTA file. If not provided, it will be automatically downloaded based on --genome . \u2014 --genome Genome used for alignment. Options: hg19 , hg38 , GRCh37 , GRCh38 , mm10 , mm39 . \u2014 --downsampling-percentages, -ds Comma-separated list of downsampling percentages (between 0 and 1, exclusive). 0.1,0.2,0.4,0.6,0.8 --minimum-coverage, -mc Minimum CpG coverage to consider for saturation. Can be a single integer or a list (e.g. 1,3,5 ). 3 --rrbs If set, MethylDackel will consider the RRBS nature of the data by adding the --keepDupes flag. False --threads, -@ Number of threads to use during downsampling. All available threads --keep-temporary-files Keep temporary files after analysis. False --verbose Enable verbose logging. False --help, -h Print the help message and exit. \u2014 --version Print the package version. \u2014","title":"downsample"},{"location":"commands/downsample/#downsample-command","text":"Option Description Default BAM (positional) Path to a single .bam file or multiple files (e.g. files/*.bam ). \u2014 --outdir, -o Output directory. ./output --fasta Path to the reference genome FASTA file. If not provided, it will be automatically downloaded based on --genome . \u2014 --genome Genome used for alignment. Options: hg19 , hg38 , GRCh37 , GRCh38 , mm10 , mm39 . \u2014 --downsampling-percentages, -ds Comma-separated list of downsampling percentages (between 0 and 1, exclusive). 0.1,0.2,0.4,0.6,0.8 --minimum-coverage, -mc Minimum CpG coverage to consider for saturation. Can be a single integer or a list (e.g. 1,3,5 ). 3 --rrbs If set, MethylDackel will consider the RRBS nature of the data by adding the --keepDupes flag. False --threads, -@ Number of threads to use during downsampling. All available threads --keep-temporary-files Keep temporary files after analysis. False --verbose Enable verbose logging. False --help, -h Print the help message and exit. \u2014 --version Print the package version. \u2014","title":"downsample command"},{"location":"commands/gt_estimator/","text":"gt-estimator command Argument Description Default BAM (positional) Path to a single .bam file or multiple files (e.g. files/*.bam ). \u2014 --outdir, -o Output directory. ./output --fasta Path to the reference genome FASTA file. If not provided, it will be automatically downloaded based on --genome . \u2014 --genome Genome used for alignment. Options: hg19 , hg38 , GRCh37 , GRCh38 , mm10 , mm39 . \u2014 --minimum-coverage, -mc Minimum CpG coverage to consider. Can be a single integer or a list (e.g. 1,3,5 ). 1 --t-step Step size for extrapolation factor ( t ) predictions. 0.05 --t-max Maximum extrapolation factor ( t ). 10.0 --compute_ci Compute confidence intervals using bootstrap replicates. False --bootstrap-replicates, -b Number of bootstrap replicates for CI computation. 30 --conf Confidence level for bootstrap intervals. 0.95 --mu Initial mu parameter for the negative binomial distribution in the EM algorithm. 0.5 --size Initial size parameter for the negative binomial distribution in the EM algorithm. 1.0 --mt Constraint for rational function approximations. 20 --rrbs If set to True , MethylDackel will use the RRBS flag ( --keepDupes ). False --threads, -@ Number of threads to use. Available threads - 2 --keep-temporary-files, -k Keep temporary files after analysis. False --verbose Enable verbose logging. False --help, -h Print the help message and exit. \u2014 --version Print the package version. \u2014","title":"gt-estimator"},{"location":"commands/gt_estimator/#gt-estimator-command","text":"Argument Description Default BAM (positional) Path to a single .bam file or multiple files (e.g. files/*.bam ). \u2014 --outdir, -o Output directory. ./output --fasta Path to the reference genome FASTA file. If not provided, it will be automatically downloaded based on --genome . \u2014 --genome Genome used for alignment. Options: hg19 , hg38 , GRCh37 , GRCh38 , mm10 , mm39 . \u2014 --minimum-coverage, -mc Minimum CpG coverage to consider. Can be a single integer or a list (e.g. 1,3,5 ). 1 --t-step Step size for extrapolation factor ( t ) predictions. 0.05 --t-max Maximum extrapolation factor ( t ). 10.0 --compute_ci Compute confidence intervals using bootstrap replicates. False --bootstrap-replicates, -b Number of bootstrap replicates for CI computation. 30 --conf Confidence level for bootstrap intervals. 0.95 --mu Initial mu parameter for the negative binomial distribution in the EM algorithm. 0.5 --size Initial size parameter for the negative binomial distribution in the EM algorithm. 1.0 --mt Constraint for rational function approximations. 20 --rrbs If set to True , MethylDackel will use the RRBS flag ( --keepDupes ). False --threads, -@ Number of threads to use. Available threads - 2 --keep-temporary-files, -k Keep temporary files after analysis. False --verbose Enable verbose logging. False --help, -h Print the help message and exit. \u2014 --version Print the package version. \u2014","title":"gt-estimator command"},{"location":"commands/plot/","text":"plot command Argument Description Default --summary , -s Path to the YML summary file. --outdir , -o Output directory. ./output --verbose Enable verbose logging. False --help , -h Print the help message and exit. --version Print the package version.","title":"plot"},{"location":"commands/plot/#plot-command","text":"Argument Description Default --summary , -s Path to the YML summary file. --outdir , -o Output directory. ./output --verbose Enable verbose logging. False --help , -h Print the help message and exit. --version Print the package version.","title":"plot command"}]}