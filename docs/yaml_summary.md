# YAML Summary File

The `methurator_summary.yml` file is generated by the `methurator downsample` command and contains all results and metadata from the analysis in a structured format.

## File Structure

```yaml
methurator_summary:
  metadata: ...
  reads_summary: ...
  cpgs_summary: ...
  saturation_analysis: ...
```

## Sections

### metadata

Contains information about the analysis run.

### reads_summary

Read counts at each downsampling percentage, grouped by sample.

```yaml
reads_summary:
- SampleName:
  - [percentage, read_count]
  - [percentage, read_count]
  ...
```

### cpgs_summary

CpG counts at each downsampling percentage, grouped by sample and minimum coverage threshold.

**Structure:**

```yaml
cpgs_summary:
- SampleName:
  - minimum_coverage: 1
    data:
    - [percentage, cpg_count]
    - [percentage, cpg_count]
    ...
  - minimum_coverage: 3
    data:
    - [percentage, cpg_count]
    ...
```

**Data columns:** `[percentage, cpg_count]`

| Column       | Description                                           |
| ------------ | ----------------------------------------------------- |
| `percentage` | Downsampling percentage (0.0-1.0)                     |
| `cpg_count`  | Number of CpGs with at least `minimum_coverage` reads |

### saturation_analysis

Curve fitting results for estimating sequencing saturation, grouped by sample and minimum coverage threshold.

**Structure:**

```yaml
saturation_analysis:
- SampleName:
  - minimum_coverage: 1
    fit_success: true
    beta0: 7791603.58
    beta1: 0.691
    asymptote: 12239022
    data:
    - [percentage, cpg_count, saturation_pct, is_predicted]
    ...
  - minimum_coverage: 3
    fit_success: false
    fit_error: "Error message..."
    data:
    - [percentage, cpg_count, null, is_predicted]
    ...
```

**Fields:**

| Field              | Type   | Description                                                                       |
| ------------------ | ------ | --------------------------------------------------------------------------------- |
| `minimum_coverage` | int    | Minimum read depth threshold                                                      |
| `fit_success`      | bool   | Whether the curve fitting succeeded                                               |
| `beta0`            | float  | First parameter of the arctangent model (only if `fit_success: true`)             |
| `beta1`            | float  | Second parameter of the arctangent model (only if `fit_success: true`)            |
| `asymptote`        | int    | Estimated maximum CpGs at infinite sequencing depth (only if `fit_success: true`) |
| `fit_error`        | string | Error message explaining why fitting failed (only if `fit_success: false`)        |
| `data`             | list   | List of observed and predicted data points                                        |

**Data columns:** `[percentage, cpg_count, saturation_pct, is_predicted]`

| Column           | Type       | Description                                                        |
| ---------------- | ---------- | ------------------------------------------------------------------ |
| `percentage`     | float      | Downsampling percentage (0.0-1.0 for observed, >1.0 for predicted) |
| `cpg_count`      | int        | Number of CpGs (observed or predicted)                             |
| `saturation_pct` | float/null | Percentage of asymptote reached (null if fitting failed)           |
| `is_predicted`   | bool       | `false` for observed data, `true` for extrapolated predictions     |
