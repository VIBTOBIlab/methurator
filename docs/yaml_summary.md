# YAML Summary File

Methurator generates YAML summary files with different structures depending on the command (`methurator downsample` or `methurator gt-estimator`) used. Both files contain metadata and analysis results in a structured format.

## Downsample summary

## File Structure

```yaml
methurator_summary:
  metadata: ...
  reads_summary: ...
  cpgs_summary: ...
  saturation_analysis: ...
```

### metadata

Contains information about the analysis run.

### reads_summary

Read counts at each downsampling percentage, grouped by sample.

```yaml
reads_summary:
- SampleName:
  - [percentage, read_count]
  - [percentage, read_count]
  ...
```

### cpgs_summary

CpG counts at each downsampling percentage, grouped by sample and minimum coverage threshold.

**Structure:**

```yaml
cpgs_summary:
- SampleName:
  - minimum_coverage: 1
    data:
    - [percentage, cpg_count]
    - [percentage, cpg_count]
    ...
  - minimum_coverage: 3
    data:
    - [percentage, cpg_count]
    ...
```

**Data columns:** `[percentage, cpg_count]`

| Column       | Description                                           |
| ------------ | ----------------------------------------------------- |
| `percentage` | Downsampling percentage (0.0-1.0)                     |
| `cpg_count`  | Number of CpGs with at least `minimum_coverage` reads |

### saturation_analysis

Curve fitting results for estimating sequencing saturation, grouped by sample and minimum coverage threshold.

**Structure:**

```yaml
saturation_analysis:
- SampleName:
  - minimum_coverage: 1
    fit_success: true
    beta0: 7791603.58
    beta1: 0.691
    asymptote: 12239022
    saturation: 81
    data:
    - [percentage, cpg_count, saturation_pct, is_predicted]
    ...
  - minimum_coverage: 3
    fit_success: false
    fit_error: "Error message..."
    data:
    - [percentage, cpg_count, null, is_predicted]
    ...
```

**Fields:**

| Field              | Type   | Description                                                                       |
| ------------------ | ------ | --------------------------------------------------------------------------------- |
| `minimum_coverage` | int    | Minimum read depth threshold                                                      |
| `fit_success`      | bool   | Whether the curve fitting succeeded                                               |
| `beta0`            | float  | First parameter of the arctangent model (only if `fit_success: true`)             |
| `beta1`            | float  | Second parameter of the arctangent model (only if `fit_success: true`)            |
| `asymptote`        | int    | Estimated maximum CpGs at infinite sequencing depth (only if `fit_success: true`) |
| `saturation`       | float  | Estimated sequencing saturation (only if `fit_success: true`)                     |
| `fit_error`        | string | Error message explaining why fitting failed (only if `fit_success: false`)        |
| `data`             | list   | List of observed and predicted data points                                        |

**Data columns:** `[percentage, cpg_count, saturation_pct, is_predicted]`

| Column           | Type       | Description                                                        |
| ---------------- | ---------- | ------------------------------------------------------------------ |
| `percentage`     | float      | Downsampling percentage (0.0-1.0 for observed, >1.0 for predicted) |
| `cpg_count`      | int        | Number of CpGs (observed or predicted)                             |
| `saturation_pct` | float/null | Percentage of asymptote reached (null if fitting failed)           |
| `is_predicted`   | bool       | `false` for observed data, `true` for extrapolated predictions     |

---

## GT-Estimator Summary

The file is generated by the `methurator gt-estimator` command using the Chao estimator for sequencing saturation extrapolation.

### File Structure

```yaml
methurator_summary:
  metadata: ...
  gt_summary: ...
```

### metadata

Contains information about the analysis run, including command parameters.

```yaml
metadata:
  date_generated: "2026-01-22T15:30:45.123456"
  methurator_version: "0.1.7"
  command: "methurator gt_estimator"
  options:
    cov_files: [...]
    outdir: "./output"
    minimum_coverage: "1"
    t_step: 0.05
    t_max: 10.0
    compute_ci: false
    bootstrap_replicates: 30
    ...
```

### gt_summary

Contains Chao's estimator extrapolation results, grouped by sample and minimum coverage threshold.

**Structure:**

```yaml
gt_summary:
- SampleName:
  - minimum_coverage: 1
    data:
    - [t, extrapolated, total_cpgs, ci_low, ci_high]
    - [t, extrapolated, total_cpgs, ci_low, ci_high]
    ...
  - minimum_coverage: 3
    data:
    - [t, extrapolated, total_cpgs, ci_low, ci_high]
    ...
```

**Fields:**

| Field              | Type | Description                                            |
| ------------------ | ---- | ------------------------------------------------------ |
| `minimum_coverage` | int  | Minimum read depth threshold for CpG calling           |
| `data`             | list | List of predictions at different extrapolation factors |

**Data columns:** `[t, extrapolated, total_cpgs, ci_low, ci_high]`

| Column         | Type      | Description                                                         |
| -------------- | --------- | ------------------------------------------------------------------- |
| `t`            | float     | Extrapolation factor (ratio of hypothetical to observed reads)      |
| `extrapolated` | string    | "True" if t > 1.0 (extrapolated), "False" if t â‰¤ 1.0 (interpolated) |
| `total_cpgs`   | int       | Predicted total number of CpGs at this extrapolation factor         |
| `ci_low`       | float/NaN | Lower confidence interval bound (NaN if `compute_ci: false`)        |
| `ci_high`      | float/NaN | Upper confidence interval bound (NaN if `compute_ci: false`)        |
